{"version":3,"sources":["start.js"],"names":[],"mappings":"AAAA;;AACA,IAAI,UAAU,QAAQ,SAAR,CAAd;AACA,IAAI,aAAa,QAAQ,aAAR,CAAjB;AACA,IAAI,SAAS,QAAQ,iBAAR,CAAb,C,CAAyC;;AAEzC,IAAI,eAAe,QAAQ,eAAR,CAAnB;AACA,IAAI,cAAc,QAAQ,oBAAR,CAAlB;;AAEA,IAAI,SAAS,QAAQ,YAAR,EAAsB,SAAtB,CAAgC,KAAhC,CAAb;;AAEA,IAAI,MAAM,SAAV;;AAEA;AACA;;AAEA,IAAI,GAAJ,CAAQ,cAAR;AACA,IAAI,GAAJ,CAAQ,WAAW,IAAX,EAAR;AACA,IAAI,GAAJ,CAAQ,WAAW,UAAX,EAAR;AACA;;;;;;;;;;AAUA,IAAI,GAAJ,CAAQ,QAAQ,MAAR,CAAe,QAAf,CAAR,E,CAAkC;AAClC;AACA,IAAI,GAAJ,CAAQ,GAAR,EAAa,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AACnC;AACA,QAAI,MAAM,IAAI,OAAJ,CAAY,MAAtB;AACA,YAAQ,GAAR,CAAY,8BAAZ,EAA4C,GAA5C;AACA,QAAG,GAAH,EAAO;AACH,YAAI,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACA,YAAI,MAAJ,CAAW,kCAAX,EAA+C,IAA/C;AACA;AACA,YAAI,MAAJ,CAAW,8BAAX,EAA0C,6GAA1C;AACH;AACD;AACA;AACH,CAZD;AAaA,IAAI,GAAJ,CAAQ,UAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,EAAwB,IAAxB,EAA8B;AAClC,YAAQ,KAAR,CAAc,+BAAd,EAA8C,IAAI,KAAlD;AACA,QAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,EAAC,IAAG,CAAJ,EAAO,KAAI,UAAX,EAArB;AACH,CAHD;AAIA,IAAI,GAAJ,CAAQ,WAAR,EAAqB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACrC,WAAO,IAAP,CAAY,gBAAZ,EAA8B,IAAI,KAAlC,EAAyC,IAAI,IAA7C;AACA,QAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,cAArB;AACH,CAHD;;AAKA,IAAI,GAAJ,CAAQ,eAAR,EAAyB,UAAU,GAAV,EAAe,GAAf,EAAoB;AACzC,QAAI,QAAJ,CAAa,yBAAb;AACH,CAFD;;AAIA,IAAI,OAAO,QAAQ,GAAR,CAAY,IAAZ,IAAoB,IAA/B;AACA,IAAI,aAAa,QAAQ,MAAR,EAAgB,YAAhB,CAA6B,GAA7B,CAAjB;;AAEA,WAAW,MAAX,CAAkB,IAAlB,EAAwB,YAAY;AAChC,YAAQ,GAAR,CAAY,4BAA4B,IAA5B,GAAmC,GAA/C;AACH,CAFD;;AAIA;AACA,IAAI,8BAA8B,QAAQ,gDAAR,CAAlC;AACA,4BAA4B,GAA5B;AACA,IAAI,wBAAwB,QAAQ,0CAAR,CAA5B;AACA,sBAAsB,GAAtB;AACA,IAAI,yBAAyB,QAAQ,2CAAR,CAA7B;AACA,uBAAuB,GAAvB;AACA","file":"start-compiled.js","sourcesContent":["'use strict';\nvar express = require('express');\nvar bodyParser = require('body-parser');\nvar config = require('./config/config'); //配置\n\nvar cookieParser = require('cookie-parser');\nvar IDGenerator = require('./util/IDGenerator');\n\nvar logger = require('./util/Log').getLogger('app');\n\nvar app = express();\n\n//var log4js = require('log4js');\n//app.use(log4js.connectLogger(log4js.getLogger(\"http\"), { level: 'auto' }));\n\napp.use(cookieParser());\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded());\n/*app.use(function (req, res, next) {\n    if(!req.cookies || !req.cookies.SESSIONID){\n        let sid = IDGenerator.sessionID();\n        console.log('========gen SESSIONID:' + sid);\n        res.cookie('SESSIONID', sid, { domain: '.hot.com', path: '/', secure: false,expires:0,signed:false });\n    }else{\n        console.log('========current SESSIONID:' + req.cookies.SESSIONID);\n    }\n    next();\n});*/\napp.use(express.static('public'));//这个static中间件放到session处理前\n//跨域\napp.all('*', function (req, res, next) {\n    //res.header('Access-Control-Allow-Origin', '*');\n    var url = req.headers.origin;\n    console.log('=====================origin:', url);\n    if(url){\n        res.header('Access-Control-Allow-Origin', url);\n        res.header('Access-Control-Allow-Credentials', true);\n        //res.header('Content-Type', 'application/json');\n        res.header(\"Access-Control-Allow-Headers\",\"Content-Type, Access-Control-Allow-Credentials,Access-Control-Allow-Origin, Authorization, X-Requested-With\");\n    }\n    //res.header('Access-Control-Allow-Methods', 'PUT, GET, POST, DELETE, OPTIONS');\n    next();\n});\napp.use(function(err, req, res, next) {\n    console.error('======inner service exception',err.stack);\n    res.status(500).json({rs:0, msg:'内部服务发生异常'});\n});\napp.get('/visa/ver', function (req, res) {\n    logger.info('query version:', req.query, req.body);\n    res.status(200).send('ver:20170606');\n});\n\napp.get('/visa/product', function (req, res) {\n    res.redirect('/visa/product/list.html');\n});\n\nvar port = process.env.PORT || 2101;\nvar httpServer = require('http').createServer(app);\n\nhttpServer.listen(port, function () {\n    console.log('server running on port ' + port + '.');\n});\n\n/*************************************** controller for admin start **************************************/\nvar productDatumTableController = require('./controller/admin/productDatumTableController');\nproductDatumTableController(app);\nvar productInfoController = require('./controller/admin/productInfoController');\nproductInfoController(app);\nvar productPriceController = require('./controller/admin/productPriceController');\nproductPriceController(app);\n/*************************************** controller for admin end **************************************/\n\n"]}